<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>客房查询</title>
    <meta content="Admin Dashboard" name="description" />
    <meta content="ThemeDesign" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="pragma" content="no-cache" />
	<meta http-equiv="Cache-Control" content="no-cache, must-revalidate" />
	<meta http-equiv="expires" content="Thu, 01 Jan 1970 00:00:01 GMT" />
	<meta http-equiv="expires" content="0" />
    <link rel="shortcut icon" href="assets/images/faviicon.png">

    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="assets/plugins/morris/morris.css">

    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="assets/css/icons.css" rel="stylesheet" type="text/css">
    <link href="assets/css/style.css" rel="stylesheet" type="text/css">

</head>

<body class="fixed-left">

    <!-- Loader -->
    <div id="preloader">
        <div id="status">
            <div class="spinner">
                <div class="rect1"></div>
                <div class="rect2"></div>
                <div class="rect3"></div>
                <div class="rect4"></div>
                <div class="rect5"></div>
              </div>
        </div>
    </div>

    <!-- Begin page -->
    <div id="wrapper">

        <!-- ========== Left Sidebar Start ========== -->
        <div class="left side-menu">
            <button type="button" class="button-menu-mobile button-menu-mobile-topbar open-left waves-effect">
                <i class="ion-close"></i>
            </button>

            <!-- LOGO -->
            <div class="topbar-left">
                <div class="text-center">
                    <!--<a href="index.html" class="logo">Admiry</a>-->
                    <a href="#" class="logo"><img src="assets/images/logo.png" height="55" alt="logo"></a>
                </div>
            </div>

            <div class="sidebar-inner slimscrollleft">

                <div class="user-details">
                    <div class="text-center">
                        <img src="assets/images/users/avatar-6.jpg" alt="" class="rounded-circle">
                    </div>
                    <div class="user-info">
                            <h4 class="font-16 text-white">管理员</h4>
                            <span class="text-white"><i class="fa fa-dot-circle-o text-success"></i>在线</span>
                    </div>
                </div>

            <div id="sidebar-menu">
                <ul>
                        <li class="menu-title text-white"></li>

                        <li>
                            <a href="admin1.html" class="waves-effect">
                                <i class="ti-home"></i>
                                <span> 首页统计 </span>
                            </a>
                        </li>

                        <li>
                            <a href="admin1-预约.html" class="waves-effect"><i class="ti-light-bulb"></i> <span> 预约管理 </span> </a>
                        </li>

                        <li>
                            <a href="admin1-入住.html" class="waves-effect"><i class="ti-crown"></i> <span> 入住管理 </span></a>
                        </li>

                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="ti-layout"></i> <span> 人员管理 </span> <span class="pull-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li><a href="admin1-会员.html">会员管理</a></li>
                                <li><a href="admin1-员工.html">员工管理</a></li>
            
                            </ul>
                        </li>

                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="ti-pencil-alt"></i><span> 客房管理 </span> <span class="pull-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li><a href="admin1-客房查询.html">客房查询</a></li>
                                <li><a href="admin1-客房类型.html">客房类型</a></li>
                                </ul>
                        </li>

                    
                    </ul> 
                </div>
                <div class="clearfix"></div>
            </div>
            <!-- end sidebarinner -->
        </div>
        <!-- Left Sidebar End -->

        <!-- Start right Content here -->

        <div class="content-page">
            <!-- Start content -->
            <div class="content">

                <!-- Top Bar Start -->
                <div class="topbar">

                    <nav class="navbar-custom">

                        <ul class="list-inline float-right mb-0">
                            <li class="list-inline-item dropdown notification-list">
                                <a class="nav-link  waves-effect"  href="admin1-用户反馈.html" role="button" aria-haspopup="false" aria-expanded="false">
                                    <i class="mdi mdi-email-outline noti-icon"></i>
                                    
                                </a>
                            </li>

                           

                            <li class="list-inline-item dropdown notification-list">
                                <a class="nav-link dropdown-toggle arrow-none waves-effect nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                                    <img src="assets/images/users/avatar-6.jpg" alt="user" class="rounded-circle">
                                </a>
                                <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                                    
                                    <a class="dropdown-item" href="../../Logout"><i class="mdi mdi-logout m-r-5 text-muted"></i> 退出</a>
                                </div>
                            </li>

                        </ul>

                        <ul class="list-inline menu-left mb-0">
                            <li class="list-inline-item">
                                <button type="button" class="button-menu-mobile open-left waves-effect">
                                    <i class="ion-navicon"></i>
                                </button>
                            </li>
                            
                        </ul>

                        <div class="clearfix"></div>

                    </nav>

                </div>
                <!-- Top Bar End -->

                <div class="page-content-wrapper ">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="card m-b-30">
                                    <div class="card-body">
                                        
                                            <div class="col-12">
                                                <h4 class="mt-0 header-title ">客房查询</h4>
                                               
                                            </div>
                                            <div class="col-12 m-h-20">
                                                    <div id="alert1"class="alert alert-success text-center" style="display:none">
                                                            <strong >操作成功!</strong> 
                                                    </div>
                                                    <div id="alert2"class="alert alert-danger text-center " style="display:none">
                                                            <strong >操作失败!</strong> 
                                                    </div>
                                                </div>
                                            </div>       
                                            <ul class="ul"> 
                                            
                                            </ul>
                                        
                                        
                                          
                                   
                                </div>
                            </div>  
                            <div class="col-lg-4">   
                                <div class="card m-b-30"> 
                                    <div class="card-body">
                                        <div class="col-12">
                                            <h4 class="mt-0 header-title">客房信息</h4>
                                        </div>
                                        <ul id="tbody" class="ul1">
                                           
                                            <li style="height: 30px">
                                                <h6 ><i class="ti-home"></i>&nbsp;&nbsp;房间号: <span class="mess1"></span></h6>
                                                
                                            </li>
                                            <li style="height: 30px">
                                                <h6><i class="ti-zoom-in "></i>&nbsp;&nbsp;房间类型: <span class="mess1"></span></h6>
                                                
                                            </li>
                                            <li style="height: 30px">
                                                <h6><i class="ti-user"></i>&nbsp;&nbsp;姓名:<span class="mess1"></span></h6>
                                               
                                            </li>
                                            <li style="height: 30px">
                                                <h6><i class="ti-id-badge"></i>&nbsp;&nbsp;会员号:<span class="mess1"></span></h6>
                                                
                                            </li>
                                            <li style="height: 30px">
                                                <h6><i class="ti-bell"></i>&nbsp;&nbsp;电话:<span class="mess1"></span></h6>
                                                
                                            </li>
                                            <li style="height: 50px">
                                                <h6><i class="ti-align-right"></i>&nbsp;&nbsp;操作:</h6>
                                            </li>
                                            <li>
                                                <div class="btn btn-info" id="tj"data-toggle="modal" data-target="#myModal2">添加</div>&nbsp;&nbsp;
                                                <div class="btn btn-danger" id="tf"data-toggle="modal" data-target="#myModal1">退房</div>&nbsp;&nbsp;
                                                <div class="btn btn-warning" id="hf" data-toggle="modal" data-target="#myModal">换房</div>
                                            </li>
                                            <li style="height: 160px">
                                                <h6><i class="ti-bell"></i>&nbsp;&nbsp;预约时段:<span class="mess1"></span></h6>
                                                
                                            </li>
                                        </ul>
                                    </div>
                                </div> 
                            </div>   
                        </div>      
                    </div><!-- container -->
                    <div class="modal fade" id="myModal">
                        <div class="modal-dialog">
                          <div class="modal-content">
                       
                            <!-- 模态框头部 -->
                            <div class="modal-header">
                              <h4 class="modal-title">换房</h4>
                              <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                       
                            <!-- 模态框主体 -->
                            <div class="modal-body">
                                <form>
                                  
                                    <div  class="form-group">
                                        <label>房间号</label>
                                        <div>
                                            <input id="room"type="number" type="text" required class="form-control"placeholder="请选择房间号"/>
                                        </div>
                                    </div>
                                    
                                 </form>   
                            </div>
                            
                            <!-- 模态框底部 -->
                            <div class="modal-footer">
                              <button  id="sendMess"type="button" class="btn btn-primary" data-dismiss="modal"onclick="update()">提交</button>
                            </div>
                       
                          </div>
                        </div>
                      </div>
                      <div class="modal fade" id="myModal1">
                        <div class="modal-dialog">
                          <div class="modal-content">
                       
                            <!-- 模态框头部 -->
                            <div class="modal-header">
                              <h4 class="modal-title">退房</h4>
                              <button type="button" class="close" data-dismiss="modal">&times;</NOtton>
                            </div>
                       
                            <!-- 模态框主体 -->
                            <div class="modal-body">
                                <form>
                                  
                                    <div  class="form-group">
                                        <label>账单</label>
                                        <div>
                                           ￥<span id = "price"></span>
                                        </div>
                                    </div>
                                    
                                 </form>   
                            </div>
                            
                            <!-- 模态框底部 -->
                            
                          </div>
                        </div>
                    </div>
                    <div class="modal fade" id="myModal2">
                            <div class="modal-dialog">
                              <div class="modal-content">
                           
                                <!-- 模态框头部 -->
                                <div class="modal-header">
                                  <h4 class="modal-title">添加入住信息</h4>
                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                           
                                <!-- 模态框主体 -->
                                <div class="modal-body">
                                    <form>
                                        <div class="form-group">
                                            <label>姓名</label>
                                            <input  id="name"type="text" class="form-control"required placeholder="请输入名字"/>
                                        </div>
                                        <div class="form-group">
                                            <label>身份证</label>
                                            <div>
                                                <input id="idCard"data-parsley-type="number" type="text" required class="form-control"placeholder="请输入身份证号"/>
                                            </div>
                                        </div>
                                        
                                        
                                     </form>   
                                </div>
                                
                                <!-- 模态框底部 -->
                                <div class="modal-footer">
                                  <button  id="sendMess"type="button" class="btn btn-primary" data-dismiss="modal"onclick="update2()">提交</button>
                                </div>
                           
                              </div>
                            </div>
                          </div>
                </div> <!-- Page content Wrapper -->
           
            </div>
            <!-- content -->

            <footer class="footer">
                ©酒店管理系统,Inc or its affiliates.  <i class="mdi mdi-heart text-danger"></i>All Rights Reserved
            </footer>

        </div>
        <!-- End Right content here -->

    </div>
    <!-- END wrapper -->

    <!-- jQuery  -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/modernizr.min.js"></script>
    <script src="assets/js/detect.js"></script>
    <script src="assets/js/fastclick.js"></script>
    <script src="assets/js/jquery.slimscroll.js"></script>
    <script src="assets/js/jquery.blockUI.js"></script>
    <script src="assets/js/waves.js"></script>
    <script src="assets/js/jquery.nicescroll.js"></script>
    <script src="assets/js/jquery.scrollTo.min.js"></script>

    <!--Morris Chart-->
    <!-- <script src="assets/plugins/morris/morris.min.js"></script>
    <script src="assets/plugins/raphael/raphael-min.js"></script>

    <script src="assets/pages/dashborad.js"></script> -->

    <!-- App js -->
    <script src="assets/js/app.js"></script>
    <!--jsrender-->
    <script src="../js/jsrender.js"></script>
    <script id = "comment" type="text/x-jsrender">
    {{for comments}}
    <li data-id={{:rid}} data-rstate={{:rstate}} style="width: 100px;height: 100px;border-radius:5px" {{if rstate == "无人" }} class="room info col-3 m-l-10 m-b-5"{{else  rstate == "有人"}}class="room danger info col-3 m-l-10 m-b-5"{{/if}}> 
        <span>{{:rid}}</span>
    </li>
    {{/for}}
    </script>
   
    <script>
        function message(b){
            var b = b;
            !!b == true ? $("#alert1").fadeIn().delay(2500).fadeOut() : $("#alert2").fadeIn().delay(2500).fadeOut();
        }
        function loadRoom(id){
            $(".ul").fadeOut("fast"); 
            $("html").attr("class","prograss-wait");
            $.getJSON("../../GetRoom",{"roomNow":id},function(res){
            	console.log(res);
                var data={};
                data.comments = res;
                
                var html = $('#comment').render(data);
                $(".ul").html(html).fadeIn("fast");
                $("html").removeAttr("class","prograss-wait");
                
            })
            first();
        }
        function first(){
        	if($(".room").eq(0).data("rstate") == "无人"){
                $("#tf").fadeOut();
                $("#hf").fadeOut();
                $("#tj").fadeIn();
            }else{
                $("#tf").fadeIn();
                $("#hf").fadeIn();
                $("#tj").fadeOut();
            }
        }
        
        loadRoom(1); 
        
        function loadMess(id){
            $.getJSON("../../GetRoomOnClick",{"roomNow":id},function(res){
                $(".mess1").eq(0).text(res.rid);
                $(".mess1").eq(1).text(res.rtype);
                $(".mess1").eq(2).text(res.vname);
                $(".mess1").eq(3).text(res.vid);
                $(".mess1").eq(4).text(res.vtel);
                $(".mess1").eq(5).text(res.reservationTime);
            })
            
        }
        loadMess(1);
        $(".ul").on("click",".room",function(){
        	
            var id = $(this).data("id");
            
            loadMess(id);
            if($(this).data("rstate") == "无人"){
                $("#tf").fadeOut();
                $("#hf").fadeOut();
                $("#tj").fadeIn();
            }else{
                $("#tf").fadeIn();
                $("#hf").fadeIn();
                $("#tj").fadeOut();
            }
        })
        function update(){
            var val = $("#room").val(),
                val1 = $(".mess1").eq(0).text();
            console.log(val)
            console.log(val1)
            $.getJSON("../../ChangeRoom",{"roomNow":val1,"roomFuture":val},function(res){
                loadRoom(val1);
                loadMess(val);
            })
        }
        function update2(){
        	
            var name = $("#name").val();
            var idCard = $("#idCard").val();
            var val1 = $(".mess1").eq(0).text();
            $.ajax({
                url:"../../AddLiveroom",
                data:{name:name,idCard:idCard,room:val1},
                dataType:"JSON",
                success:function(res){	
              
                	console.log(res)
                    if(!res.type){
                        message(res.type);
                        return;
                    }
                	loadRoom(val1);
                    loadMess(val1);
                    
                    message(res.type);
                }
            })
        }
        $("#tf").on("click",function(){
            var val1 = $(".mess1").eq(0).text();
            $.getJSON("../../RstreatsRoom",{"roomNow":val1},function(res){
                loadRoom(val1);
                loadMess(val1);
                $("#price").text(res.price)
            })
        })

    </script>
</body>

</html>